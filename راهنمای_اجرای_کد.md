# راهنمای اجرای کد - سیستم تشخیص قفسه

## پیش‌نیازها

1. **Python 3.8 یا بالاتر** - [دانلود Python](https://www.python.org/downloads/)
2. **pip** (معمولاً با Python نصب می‌شود)

## مراحل نصب و اجرا

### مرحله 1: نصب وابستگی‌ها

```bash
# رفتن به پوشه backend
cd backend

# ایجاد محیط مجازی (اختیاری اما توصیه می‌شود)
python -m venv venv

# فعال‌سازی محیط مجازی
# در Windows:
venv\Scripts\activate
# در Linux/Mac:
source venv/bin/activate

# نصب پکیج‌های مورد نیاز
pip install -r requirements.txt
```

### مرحله 2: تنظیم دیتابیس

```bash
# رفتن به پوشه backend (اگر نیستید)
cd backend

# اجرای migrations برای ایجاد جداول دیتابیس
python manage.py migrate

# ایجاد کاربر ادمین (اختیاری)
python manage.py createsuperuser
```

### مرحله 3: اجرای سرور

**روش 1: استفاده از فایل batch (توصیه می‌شود)**

```bash
# در ریشه پروژه (همان پوشه که start_backend.bat است)
start_backend.bat
```

این فایل به صورت خودکار:
- محیط مجازی را ایجاد می‌کند (اگر وجود نداشته باشد)
- وابستگی‌ها را نصب می‌کند
- migrations را اجرا می‌کند
- سرور را راه‌اندازی می‌کند

**روش 2: اجرای دستی**

```bash
# رفتن به پوشه backend
cd backend

# فعال‌سازی محیط مجازی (اگر ایجاد کرده‌اید)
venv\Scripts\activate  # Windows
# یا
source venv/bin/activate  # Linux/Mac

# اجرای migrations
python manage.py migrate

# اجرای سرور
python manage.py runserver
```

سرور روی آدرس زیر اجرا می‌شود:
- **http://127.0.0.1:8000** یا **http://localhost:8000**

### مرحله 4: دسترسی به برنامه

1. **صفحه اصلی**: http://127.0.0.1:8000
2. **ثبت نام**: http://127.0.0.1:8000/register/
3. **ورود**: http://127.0.0.1:8000/login/
4. **داشبورد**: http://127.0.0.1:8000/dashboard/

## استفاده از سیستم

### 1. ثبت نام و ورود

- ابتدا یک حساب کاربری ایجاد کنید
- سپس وارد سیستم شوید

### 2. آپلود تصویر

1. در داشبورد، به بخش "آپلود تصویر" بروید
2. یک تصویر از قفسه انتخاب کنید (JPG, PNG, GIF)
3. سیستم به صورت خودکار نوع عکس را تشخیص می‌دهد:
   - **IF**: عکس سس‌ها → نمایش 4 نوع سس (A, B, C, D)
   - **ELSE**: عکس چیپس‌ها → نمایش 4 نوع چیپس (قرمز، سبز، آبی، بنفش)

### 3. مشاهده نتایج

پس از آپلود، نتایج شامل:
- تعداد کل محصولات شناسایی شده
- تعداد مدل‌های مختلف
- جزئیات هر محصول با تعداد و درصد اطمینان

### 4. مدیریت محصولات

- می‌توانید محصولات جدید اضافه کنید
- محصولات شناسایی شده به صورت خودکار به لیست اضافه می‌شوند

## ساختار پروژه

```
backend/
├── inventory_app/          # اپلیکیشن اصلی
│   ├── views.py           # API endpoints
│   ├── inference_service.py  # تحلیل تصاویر (IF/ELSE)
│   ├── models.py          # مدل‌های دیتابیس
│   └── urls.py            # مسیرهای API
├── inventory_project/      # تنظیمات پروژه
│   ├── settings.py        # تنظیمات Django
│   └── urls.py            # مسیرهای اصلی
├── templates/             # قالب‌های HTML
│   ┌── dashboard.html     # صفحه داشبورد
└── static/               # فایل‌های استاتیک
    ├── css/              # استایل‌ها
    └── js/               # JavaScript
```

## نکات مهم

1. **IF/ELSE برای دو عکس**: سیستم به صورت خودکار نوع عکس را تشخیص می‌دهد (سس یا چیپس)
2. **بدون نیاز به آموزش مدل**: این یک MVP است و از تحلیل ساده استفاده می‌کند
3. **دیتابیس**: از SQLite استفاده می‌شود (برای تولید از PostgreSQL استفاده کنید)

## عیب‌یابی

### مشکل: عکس آپلود نمی‌شود
- مطمئن شوید فایل فرمت معتبر دارد (JPG, PNG, GIF)
- بررسی کنید که سرور در حال اجرا است
- Console مرورگر را برای خطاها بررسی کنید

### مشکل: محصول اضافه نمی‌شود
- مطمئن شوید نام محصول خالی نیست
- بررسی کنید که محصول قبلاً ثبت نشده باشد
- Console مرورگر را برای خطاها بررسی کنید

### مشکل: سرور اجرا نمی‌شود
- مطمئن شوید Python نصب است: `python --version`
- وابستگی‌ها را نصب کنید: `pip install -r requirements.txt`
- پورت 8000 را بررسی کنید (ممکن است در حال استفاده باشد)

## پشتیبانی

در صورت بروز مشکل، لاگ‌های سرور را بررسی کنید که در ترمینال نمایش داده می‌شوند.

